<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Raspbian WiFi Configuration Portal</title>

  <!-- Bootstrap Core CSS -->
  <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- MetisMenu CSS -->
  <link href="bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">

  <!-- Timeline CSS -->
  <link href="dist/css/timeline.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link href="dist/css/sb-admin-2.css" rel="stylesheet">

  <!-- Morris Charts CSS -->
  <link href="bower_components/morrisjs/morris.css" rel="stylesheet">

  <!-- Custom Fonts -->
  <link href="bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <!-- Custom CSS -->
  <link href="dist/css/custom.css" title="main" rel="stylesheet">

  <link rel="shortcut icon" type="image/png" href="img/favicon.png">
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body onload="sidemenu_get(),connect_data_get()">

  <div id="wrapper">
    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle Navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        <a class="navbar-brand" href="index_login">RaspAP Wifi Portal v1.3.0</a>
      </div>
      <!-- /.navbar-header -->

      <!-- Navigation -->
      <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
          <ul class="nav" id="side-menu">
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
      <!-- /.navbar-default -->
    </nav>

    <div id="page-wrapper">

      <!-- Page Heading -->
      <div class="row">
        <div class="col-lg-12">
          <h1 class="page-header">
              <img class="logo" src="img/raspAP-logo.png" width="45" height="45">RaspAP
            </h1>
        </div>
      </div>
      <!-- /.row -->

      <div class="row">
        <div class="col-lg-12">
          <div class="panel panel-primary">
            <div class="panel-heading"><i class="fa fa-cube fa-fw"></i> System</div>
            <div class="panel-body">

              <!--
              <div class="alert alert-warning">System Rebooting Now!</div>
              <div class="alert alert-warning">System Shutting Down Now!</div>
            -->
              <div class="row">
                <div class="col-md-12">
                  <div class="panel panel-default">
                    <div class="panel-body">
                      <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active systemtab"><a href="#system" aria-controls="system" role="tab" data-toggle="tab">System</a></li>
                        <li role="presentation" class="consoletab"><a href="#console" aria-controls="console" role="tab" data-toggle="tab">Console</a></li>
                      </ul>

                      <div class="systemtabcontent tab-content">
                        <div role="tabpanel" class="tab-pane active" id="system">
                          <div class="row">
                            <div class="col-lg-6">
                              <div id="system_infor_div_id">
                                <h4>System Information</h4>
                                <div class="info-item">Hostname</div>
                                </br>
                                <div class="info-item">Pi Revision</div>
                                </br>
                                <div class="info-item">Uptime</div>
                                </br>
                                </br>
                              </div>
                              <div id="system_infor_bar_div_id">
                                <div class="info-item">Memory Used</div>
                                <div class="progress">
                                  <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" aria-valuenow="" aria-valuemin="0" aria-valuemax="100" style="width:10%;">

                                  </div>
                                </div>
                                <div class="info-item">CPU Load</div>
                                <div class="progress">
                                  <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" aria-valuenow="" aria-valuemin="0" aria-valuemax="100" style="width:20%;">

                                  </div>
                                </div>
                              </div>
                              <form action="?page=system_info" method="POST">
                                <input type="button" class="btn btn-warning" name="system_reboot" value="Reboot" onclick="Reboot_button()" />
                                <input type="button" class="btn btn-warning" name="system_shutdown" value="Shutdown" onclick="shutdown_button()" />
                                <input type="button" class="btn btn-outline btn-primary" value="Refresh" onclick="connect_data_get()" />
                              </form>
                            </div>
                          </div>
                        </div>
                        <!--
                          <div role="tabpanel" class="tab-pane" id="console">
                            <iframe src="includes/webconsole.php" class="webconsole"></iframe>
                          </div>
                          -->


                      </div>
                      <!-- /.panel-body -->
                    </div>
                    <!-- /.panel-default -->
                  </div>
                  <!-- /.col-md-6 -->
                </div>
                <!-- /.row -->
              </div>
              <!-- /.panel-body -->
            </div>
            <!-- /.panel-primary -->
          </div>
          <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->




      </div>
    </div>
  </div>
  <!-- /#page-wrapper -->
  </div>
  <!-- /#wrapper -->

  <!-- RaspAP JavaScript -->
  <script src="dist/js/functions.js"></script>

  <!-- jQuery -->
  <script src="bower_components/jquery/dist/jquery.min.js"></script>

  <!-- Bootstrap Core JavaScript -->
  <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

  <!-- Metis Menu Plugin JavaScript -->
  <script src="bower_components/metisMenu/dist/metisMenu.min.js"></script>

  <!-- json data JavaScript -->

  <!-- side menu JavaScript -->
  <script src="side_menu/functions.js"></script>

  <!-- Morris Charts JavaScript -->
  <!--script src="bower_components/raphael/raphael-min.js"></script-->
  <!--script src="bower_components/morrisjs/morris.min.js"></script-->
  <!--script src="js/morris-data.js"></script-->

  <!-- Custom Theme JavaScript -->
  <script src="dist/js/sb-admin-2.js"></script>
  <script>
    function system_infor_box_fill(data) {
      var content = "<h4>System Information</h4>";
      var type = "system_Information";
      var index = 0;

      for (var name in data[type]) {
        index++;
        if(index > 3){
          break;
        }
        content += "<div class=info-item>" + name + "</div>" + data[type][name] + "</br>";
      }
      content += "<br>";
      return content;
    }

    function system_infor_bar_box_fill(data) {
      var content = "";
      var index = 0;
      var type = "system_Information";
      for (var name in data[type]) {
        index++;
        if(index > 3){
          content += "<div class=info-item>" + name + "</div><div class=progress>";
          content += "<div class='progress-bar progress-bar-info progress-bar-striped active' role=progressbar aria-valuenow aria-valuemin=0 aria-valuemax=100 style=width:" + data[type][name] + "%;></div></div>"
        }
      }
      return content;
    }
    function refresh_button(data){
      document.getElementById("system_infor_div_id").innerHTML = system_infor_box_fill(data);
      document.getElementById("system_infor_bar_div_id").innerHTML = system_infor_bar_box_fill(data);
    }
    function connect_data_get(){
      const xhr = new XMLHttpRequest();
      // by default async
      xhr.onload = function() {
        if (this.readyState == 4 && this.status == 200) { // onload called even on 404 etc so check the status
          var data = this.response;
          refresh_button(data);
        }
      };
      xhr.onerror = function() {
        console.log("confirm");
      };
      xhr.open("GET", "/api/system?type=refresh");
      xhr.responseType = 'json';
      xhr.send();
    }

    function Reboot_button() {
      const xhr = new XMLHttpRequest();
      // by default async
      xhr.onload = function() {
        if (this.readyState == 4 && this.status == 200) { // onload called even on 404 etc so check the status
          var data = this.response;
          //button_input(data['success']);
        }
      };
      xhr.onerror = function() {
        console.log("confirm");
      };
      xhr.open("GET", "/api/system?type=reboot");
      xhr.responseType = 'json';
      xhr.send();
    }

    function shutdown_button() {
      const xhr = new XMLHttpRequest();
      // by default async
      xhr.onload = function() {
        if (this.readyState == 4 && this.status == 200) { // onload called even on 404 etc so check the status
          var data = this.response;
          //button_input(data['success']);
        }
      };
      xhr.onerror = function() {
        console.log("confirm");
      };
      xhr.open("GET", "/api/system?type=shutdown");
      xhr.responseType = 'json';
      xhr.send();
    }

    function button_input(data) {
      var content = "";
      if (data == 1) {
        content = "<input type=button class='btn btn-outline btn-primary' value='Save settings' name=savedhcpdsettings onclick=savesetting_button() />";
        content += "<input type=button class='btn btn-warning' value='Stop dnsmasq' name='stopdhcpd' onclick=change_dnsmasq_stopstart_button(0) />";
      } else if (data == 2) {
        content = "<input type=button class='btn btn-outline btn-primary' value='Save settings' name=savedhcpdsettings onclick=savesetting_button() />";
        content += "<input type=button class='btn btn-success' value='Start dnsmasq' name='stopdhcpd' onclick=change_dnsmasq_stopstart_button(1) />";
      }
      document.getElementById("startstop_button_id").innerHTML = content;
    }

  </script>

</body>

</html>
